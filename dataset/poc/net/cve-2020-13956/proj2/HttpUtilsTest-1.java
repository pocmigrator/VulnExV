import static org.junit.Assert.assertTrue;

import org.junit.Test;
import org.apache.http.impl.client.CloseableHttpClient;

public class HttpUtilsTest {

    @Test
    public void testVulnerabilityTriggeredInDoGet() {
        // Test input data
        String input = "http://user@apache.org:80@google.com/";

        // Intercept the method call to CloseableHttpClient.execute
        MethodCallInterceptor.interceptor(
                CloseableHttpClient.class, "execute", new Object[] { input });

        try {
            // Call the method under test
            HttpUtils.doGet(input);
        } catch (Exception e) {
            // Do nothing after catching the exception
        }

        // Assert that the vulnerability was successfully triggered
        assertTrue(MethodCallInterceptor.isTrigger);
    }
}
